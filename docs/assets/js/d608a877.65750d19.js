"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[796],{986:(t,e,o)=>{o.r(e),o.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>h});var n=o(4848),i=o(8453),s=o(9229);const r={sidebar_position:1},a="The mesh sidecar",c={id:"sidecar/index",title:"The mesh sidecar",description:"This page is still being written. Please be patient :)",source:"@site/docs/sidecar/index.mdx",sourceDirName:"sidecar",slug:"/sidecar/",permalink:"/otoroshictl/docs/sidecar/",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Universal mesh",permalink:"/otoroshictl/docs/category/universal-mesh"},next:{title:"Inside a kubernetes cluster",permalink:"/otoroshictl/docs/sidecar/kubernetes"}},l={},h=[];function d(t){const e={code:"code",h1:"h1",p:"p",pre:"pre",...(0,i.R)(),...t.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h1,{id:"the-mesh-sidecar",children:"The mesh sidecar"}),"\n",(0,n.jsx)(e.p,{children:"This page is still being written. Please be patient :)"}),"\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:"otoroshictl"})," sidecar allow to create a service mesh that can work inside and/or outside a kubernetes cluster"]}),"\n",(0,n.jsx)(s.A,{not_:!0,command:"otoroshictl sidecar -ht",result:"\n\nManage an otoroshi mesh sidecar\n\nUsage: otoroshictl sidecar [OPTIONS] <COMMAND>\n\nCommands:\n  howto            Display instructions to install/run the sidecar\n  run              Run otoroshi sidecar\n  generate-config\n  install          Install transparent proxing of the mesh calls through iptables rules\n  uninstall        Uninstall transparent proxing of the mesh calls through iptables rules\n  help             Print this message or the help of the given subcommand(s)\n\nOptions:\n  -v, --verbose\n          Turn debugging information on\n  -o, --ouput <FORMAT>\n          Change the rendering format (can be one of: json, yaml, json_pretty)\n  -c, --config-file <FILE or URL>\n          Sets a custom config file\n      --otoroshi-cluster-tls\n          Sets the tls flag to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-cluster-hostname <HOSTNAME>\n          Sets the hostname to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-cluster-port <PORT>\n          Sets the port to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-cluster-routing-tls\n          Sets the tls flag to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-cluster-routing-hostname <HOSTNAME>\n          Sets the hostname to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-cluster-routing-port <PORT>\n          Sets the port to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-user-client-id <CLIENT_ID>\n          Sets the client_id to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-user-client-secret <CLIENT_SECRET>\n          Sets the client_secret to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-user-health-key <HEALTH_KEY>\n          Sets the health_key to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-cluster-cert-location <FILE>\n          Sets the client cert location to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-cluster-key-location <FILE>\n          Sets the client cert key location to connect to a custom otoroshi cluster without using a config file\n      --otoroshi-cluster-ca-location <FILE>\n          Sets the client cert ca location to connect to a custom otoroshi cluster without using a config file\n  -h, --help\n          Print help\n"}),"\n",(0,n.jsx)(e.p,{children:"the config. file format is the following"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-yaml",children:"apiVersion: proxy.otoroshi.io/v1\nkind: Sidecar\nmetadata:\n  name: my-sidecar\nspec:\n  # optional\n  kubernetes: false\n  # catch DNS request to route *.otoroshi.mesh to otoroshi, can be disabled in kubernetes if coredns is configured\n  dns_integration: true\n  # optional the mesh domain to catch\n  dns_domain: .otoroshi.mesh\n  # how to talk to the local otoroshi cluster\n  otoroshi:\n    # location can be omitted in kubernetes\n    location:\n      hostname: otoroshi-api.oto.tools\n      kubernetes:\n        service: otoroshi-service\n        namespace: otoroshi\n      port: 9999\n      tls: false\n    # location can be omitted in kubernetes\n    routing_location:\n      hostname: routing.oto.tools\n      kubernetes:\n        service: otoroshi-service\n        namespace: otoroshi\n      port: 9998\n      tls: true\n    credentials:\n      # we must support file path here or ENV.name\n      client_id: admin-api-apikey-id\n      client_secret: admin-api-apikey-secret\n    client_cert:\n      # optional\n      cert_location: /tmp/cert.pem\n      # optional\n      cert_value: |\n        ---- BEGIN CERTIFICATE -----\n        xxxxxxxxxxxxxxxxxxx\n        ---- END CERTIFICATE ----\n      # optional\n      key_location: /tmp/cert.pem\n      # optional\n      key_value: |\n        ---- BEGIN PRIVATE KEY -----\n        xxxxxxxxxxxxxxxxxxx\n        ---- END PRIVATE KEY ----\n  # how we expose the local app\n  inbound:\n    port: 15000\n    # optional\n    target_port: 3000\n    # optional\n    target_hostname: api-a.foo.bar\n    tls: \n      enabled: true\n      # optional otoroshi certificate id\n      cert_id: jEVeLxI2eeAfyeFcZ0pRIN5EOqp8bYxWqVw43e7r3CQtUM6hl8VmsJiOJOPYpXiv\n    mtls:\n      enabled: true\n      # optional otoroshi ca certificate id\n      ca_cert_id: otoroshi-intermediate-ca\n    otoroshi_protocol:\n      enabled: true\n      # optional otoroshi route id to get config if symmetrical\n      route_id: xxxx\n      # optional\n      secret: xxxxx\n      # optional\n      algo: HS256\n      # optional\n      version: V2\n      # optional\n      header_in_name: xxxx\n      # optional\n      header_out_name: xxxx\n  # what we want to call from the local app and how\n  outbounds:\n    # optional internal proxy port\n    port: 15001\n    sidecar-outbound.otoroshi.mesh:\n      # can be omitted if same as key\n      hostname: sidecar-outbound.otoroshi.mesh\n      # optional\n      path: /api/.*\n      apikey: \n        enabled: true\n        # optional otoroshi apikey entity id\n        apikey_id: apki_oDJ0IJT4ReBnhOlP\n      mtls: \n        enabled: true\n        # optional otoroshi certificate id\n        client_cert_id: otoroshi-client\n    service-b.otoroshi.mesh:\n      # can be omitted if same as key\n      hostname: service-b.otoroshi.mesh\n      # optional\n      path: /.*\n      apikey: \n        enabled: true\n        # optional otoroshi apikey entity id\n        apikey_id: apki_oDJ0IJT4ReBnhOlP\n        enabled: true\n        # optional otoroshi certificate id\n        client_cert_id: otoroshi-client\n"})})]})}function u(t={}){const{wrapper:e}={...(0,i.R)(),...t.components};return e?(0,n.jsx)(e,{...t,children:(0,n.jsx)(d,{...t})}):d(t)}},9229:(t,e,o)=>{o.d(e,{A:()=>s});var n=o(6540),i=o(4848);class s extends n.Component{state={copy:!1};copy=()=>{this.setState({copy:!0},(()=>{navigator.clipboard.writeText(this.props.command),setTimeout((()=>{this.setState({copy:!1})}),1e3)}))};render(){const t=this.state.copy?"rgb(40, 167, 69)":"white";let e=(this.props.command||"").trim();return e.startsWith("\n")&&(e=e.substring(1)),e.startsWith("$ ")&&(e=e.substring(2)),(0,i.jsx)("div",{className:"terminal-component",style:{width:"100%",marginTop:20},children:(0,i.jsxs)("div",{style:{maxWidth:"100%",display:"flex",flexDirection:"column",borderRadius:5},children:[(0,i.jsxs)("div",{style:{borderTopLeftRadius:5,borderTopRightRadius:5,height:"2rem",gap:".35rem",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",background:"#3f52e3",color:"white"},children:[(0,i.jsx)("div",{style:{marginLeft:".35rem",width:10,height:10,borderRadius:"50%",backgroundColor:"#ccc"}}),(0,i.jsx)("div",{style:{width:10,height:10,borderRadius:"50%",backgroundColor:"#ccc"}}),(0,i.jsx)("div",{style:{width:10,height:10,borderRadius:"50%",backgroundColor:"#ccc"}}),(0,i.jsx)("span",{style:{width:"100%"}}),(0,i.jsx)("div",{style:{cursor:"pointer",width:30,height:30},onClick:this.copy,children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:t,className:"w-5 h-5",children:(0,i.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})})})]}),(0,i.jsxs)("pre",{style:{display:"block",overflowX:"auto",background:"#002451",color:"white",padding:"1rem 12px 1rem",borderTopLeftRadius:0,borderTopRightRadius:0,borderBottomRightRadius:5,borderBottomLeftRadius:5},children:[(0,i.jsx)("code",{className:"language-bash",style:{whiteSpace:"pre"},children:(0,i.jsxs)("span",{children:["$ ",e]})}),this.props.result&&(0,i.jsx)("code",{className:"language-bash",style:{whiteSpace:"pre"},children:(0,i.jsx)("span",{children:this.props.result})})]})]})})}}},8453:(t,e,o)=>{o.d(e,{R:()=>r,x:()=>a});var n=o(6540);const i={},s=n.createContext(i);function r(t){const e=n.useContext(s);return n.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function a(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(i):t.components||i:r(t.components),n.createElement(s.Provider,{value:e},t.children)}}}]);